#!/usr/bin/python
import os
import sys

PY_VERSION = '%d.%d'%(sys.version_info[0], sys.version_info[1])
PY_DIR = 'python-%s'%(PY_VERSION)

# source: https://github.com/openshift/flask-example
sys.path.insert(0, os.path.dirname(__file__) or '.')

# add libs
sys.path.append(os.path.join(os.getenv("OPENSHIFT_REPO_DIR"), "libs"))

if os.path.exists(os.path.join(os.environ['OPENSHIFT_HOMEDIR'], PY_DIR)):
    PY_DIR = os.path.join(os.environ['OPENSHIFT_HOMEDIR'], PY_DIR)
else:
    PY_DIR = os.path.join(os.environ['OPENSHIFT_HOMEDIR'], 'python')

virtenv = PY_DIR + '/virtenv/'

PY_CACHE = os.path.join(virtenv, 'lib', PY_VERSION, 'site-packages')

os.environ['PYTHON_EGG_CACHE'] = os.path.join(PY_CACHE)
virtualenv = os.path.join(virtenv, 'bin/activate_this.py')

try:
    execfile(virtualenv, dict(__file__=virtualenv))
except IOError:
    pass

# Workaround for inaccurate victims-web config
os.environ['OPENSHIFT_DB_HOST'] = os.environ['OPENSHIFT_MONGODB_DB_HOST']
os.environ['OPENSHIFT_DB_PORT'] = os.environ['OPENSHIFT_MONGODB_DB_PORT']
os.environ['OPENSHIFT_DB_USERNAME'] = os.environ['OPENSHIFT_MONGODB_DB_USERNAME']
os.environ['OPENSHIFT_DB_PASSWORD'] = os.environ['OPENSHIFT_MONGODB_DB_PASSWORD']


from victims_web.application import app as application

